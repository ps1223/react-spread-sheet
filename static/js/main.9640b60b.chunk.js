(this["webpackJsonpreact-spread-sheet"]=this["webpackJsonpreact-spread-sheet"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var o=n(1),r=n.n(o),i=n(9),s=n.n(i),l=(n(14),n(15),n(2)),a=n(3),c=n(4),u=n(6),h=n(5),d=n(7),b=n(0),p=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"onChange",value:function(e,t,n){this.props.onChange(e,t,n.target.value)}},{key:"shouldComponentUpdate",value:function(e,t,n){return this.props.value!==e.value||this.props.isSelected!==e.isSelected||this.props.showCopied!==e.showCopied||this.props.isEditable!==e.isEditable}},{key:"render",value:function(){var e=this.props,t=e.row,n=e.column,o=e.value,r=e.isHeader,i=e.isSelected,s=e.isEditable,l=e.showCopied,a=e.onClick,c=e.onMouseEnter,u=e.style,h=i?f:{},p=l&&i?C:{},v=r?j:{},m=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},w),h),p),v),u);return Object(b.jsx)("div",{style:m,onMouseDown:a.bind(null,t,n),onMouseEnter:c.bind(null,t,n),onClick:a.bind(null,t,n),children:s?Object(b.jsx)("input",{value:o,autoFocus:!0,onChange:this.onChange.bind(this,t,n)}):Object(b.jsx)("span",{children:o})})}}]),n}(r.a.Component),C={border:"2px dotted green",height:23,width:98},f={border:"2px solid green",height:23,width:98},w={width:100,height:25,textAlign:"center",border:"1px solid #888"},j={backgroundColor:"#CCC",textTransform:"uppercase"};var v=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(b.jsx)(p,{value:"+",isHeader:!0,style:m,onMouseDown:function(){},onMouseUp:function(){},onMouseEnter:function(){},onClick:this.props.onClick})}}]),n}(r.a.Component),m={width:30,color:"green",backgroundColor:"white",border:"1px solid",fontWeight:"bold",cursor:"pointer"},k=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.row,n=e.rowIndex,o=e.isHeader,r=e.selectedCell,i=e.editableCell,s=e.showCopied,a=e.onAdd,c=e.onChange,u=e.onClick,h=e.onMouseEnter,d=Object(l.a)(r.row).sort((function(e,t){return e-t})),C=Object(l.a)(r.column).sort((function(e,t){return e-t}));return Object(b.jsxs)("div",{style:{display:"flex"},children:[Object(b.jsx)(p,{isHeader:!0,style:{width:30},onMouseEnter:function(){},value:o?" ":n+1,onClick:function(){}}),t.map((function(e,r){var l=function(e){for(var t="a".charCodeAt(0),n="z".charCodeAt(0)-t+1,o="";e>=0;)o=String.fromCharCode(e%n+t)+o,e=Math.floor(e/n)-1;return o}(r);o&&(e=l);var a=d[0]<=n&&d[1]>=n&&C[0]<=r&&C[1]>=r,f=i&&i.row===n&&i.column===r;return Object(b.jsx)(p,{row:n,column:r,isHeader:o,isSelected:a,showCopied:s,isEditable:f,onChange:c,onMouseEnter:h,onClick:u,value:e},"".concat(l).concat(t))})),o&&Object(b.jsx)(v,{onClick:a})]})}}]),n}(r.a.Component),y=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var o;Object(a.a)(this,n),o=t.call(this,e);var r=new Array(e.row).fill(null).map((function(t){return new Array(e.column).fill("")}));return o.state={row:e.row,column:e.column,clipboard:null,selectedCell:{row:[],column:[]},showCopied:!1,editableCell:{row:null,column:null},sheet:r},o}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",(function(t){e.handleKeyEvents(t)}))}},{key:"onChange",value:function(e,t,n){var o=Object(l.a)(this.state.sheet);o[e][t]=n,this.setState({sheet:o})}},{key:"onMouseEnter",value:function(e,t,n){1===n.buttons&&this.onClick(e,t,n)}},{key:"onClick",value:function(e,t,n){n.preventDefault();var o=this.state,r=o.editableCell,i=o.selectedCell;n.shiftKey||1===n.buttons&&"mousedown"!==n.type?(r.row=null,r.column=null):(r.row=e,r.column=t,i.row[0]=e,i.column[0]=t),i.row[1]=e,i.column[1]=t,this.setState({showCopied:!1,editableCell:r,selectedCell:i})}},{key:"addRow",value:function(){var e=Object(l.a)(this.state.sheet);e.push(new Array(this.state.column).fill("")),this.setState({row:this.state.row+1,sheet:e})}},{key:"addColumn",value:function(){var e=Object(l.a)(this.state.sheet);e.forEach((function(e){return e.push("")})),this.setState({column:this.state.column+1,sheet:e})}},{key:"handleKeyEvents",value:function(e){var t=this.state.selectedCell;if("c"===e.key&&e.ctrlKey){if(t.row.length>0){for(var n=Object(l.a)(t.row).sort(),o=Object(l.a)(t.column).sort(),r=[],i=n[0];i<=n[1];i++){for(var s=[],a=o[0];a<=o[1];a++)s.push(this.state.sheet[i][a]);r.push(s)}this.setState({showCopied:!0,clipboard:r})}}else"v"===e.key&&e.ctrlKey?this.state.clipboard&&(this.pasteData(),e.preventDefault()):"Tab"===e.key?this.setState({isSelectionMode:!1}):"ArrowLeft"===e.key?t.column[1]>0&&this.onClick(t.row[1],t.column[1]-1,e):"ArrowRight"===e.key?t.column[1]<this.state.column-1&&this.onClick(t.row[1],t.column[1]+1,e):"ArrowUp"===e.key?t.row[1]>0&&this.onClick(t.row[1]-1,t.column[1],e):"ArrowDown"===e.key&&t.row[1]<this.state.row-1&&this.onClick(t.row[1]+1,t.column[1],e)}},{key:"pasteData",value:function(){var e=this.state,t=e.clipboard,n=e.selectedCell,o=e.row,r=e.column,i=n.row[0],s=n.column[0],a=i+t.length-o,c=s+t[0].length-r,u=Object(l.a)(this.state.sheet);this.increaseSpreadSheet(a,u,"row"),this.increaseSpreadSheet(c,u,"column");for(var h=0;h<t.length;h++)for(var d=0;d<t[0].length;d++)u[h+i][d+s]=t[h][d];this.setState({sheet:u,row:o+(a>0?a:0),column:r+(c>0?c:0),editableCell:{row:null,column:null}})}},{key:"increaseSpreadSheet",value:function(e,t,n){if(e>0)for(var o=0;o<e;o++)"row"===n?t.push(new Array(t[0].length).fill("")):t.forEach((function(e){return e.push("")}));return t}},{key:"render",value:function(){var e=this,t=this.state,n=t.sheet,o=t.column,r=t.editableCell,i=t.selectedCell,s=t.showCopied;return Object(b.jsxs)("div",{style:{width:103*this.state.column+60},children:[Object(b.jsx)(k,{row:new Array(o).fill(""),onMouseEnter:function(){},onClick:function(){},selectedCell:i,onAdd:this.addColumn.bind(this),isHeader:!0}),n.map((function(t,n){return Object(b.jsx)(k,{row:t,showCopied:s,rowIndex:n,editableCell:r,selectedCell:i,onMouseEnter:e.onMouseEnter.bind(e),onChange:e.onChange.bind(e),onClick:e.onClick.bind(e)},n)})),Object(b.jsx)(v,{onClick:this.addRow.bind(this)})]})}}]),n}(r.a.Component);var O=function(){return Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(y,{row:5,column:5})})},g=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,o=t.getFID,r=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),o(e),r(e),i(e),s(e)}))};s.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(O,{})}),document.getElementById("root")),g()}},[[17,1,2]]]);
//# sourceMappingURL=main.9640b60b.chunk.js.map